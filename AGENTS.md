# Repository Guidelines

## 项目结构与模块划分
- `main.py`：项目入口，组装角色名单并调用循环赛/日志输出。
- `bh3_duel_sim/`：核心包，含 `characters/`（基类与女武神实现）、`simulator.py`（回合驱动与统计）、`stats.py`（属性定义）、`logger.py`（日志器）。
- `pyproject.toml` 与 `uv.lock`：由 uv 管理的依赖与环境描述文件；新增模块、工具时务必同步更新。

## 构建、运行与开发命令
- `python3 main.py`：执行 1 万场循环赛并输出一场示例对局日志，是最基本的回归命令。
- `uv run pyright`：在 uv 环境中运行静态类型检查，快速捕捉导入/类型错误。
- 若需添加依赖，使用 `uv add <package>`，保持锁文件一致。

## 编码风格与命名
- 所有实现需模仿 Linus Torvalds 的编程风格：直白、精简、以可维护性优先，避免神秘魔法与过度抽象。
- 模块设计坚持高内聚、低耦合；公共接口集中在 `bh3_duel_sim/` 包，子类逻辑在各自文件内自洽。
- 全项目坚持中文注释/日志，类与函数须写函数级文档字符串，复杂片段才能补行内注释。
- Python 代码使用 4 空格缩进，保持基类与子类命名为 `PascalCase`，普通函数/变量使用 `snake_case`。
- 模块内导入优先使用包内相对写法（例如 `from .base import BaseCharacter`）以避免解析红线。
- 所有代码修改交付前必须运行 `uv run ruff check .`，直至 lint 通过（无报错）才可交付给用户。

## 测试准则
- 目前以 `python3 main.py` 作为最小运行测试；新增算法时需至少跑一遍并人工检查日志。
- 若添加专门测试脚本，请放在 `tests/`（尚未创建）并以 `test_*.py` 命名，运行方式统一为 `python3 -m pytest`（未来扩展）。
- 对概率逻辑应给出固定 `seed` 的再现实例，保证回归可复现。

## 提交与合并
- 提交信息保持“范围: 简述”的格式，例如 `simulator: add round robin stats`，突出修改模块。
- PR 需包含：变更摘要、测试命令及结果、受影响角色/模块列表，如涉及平衡调整应附胜率对比截图或数字。
- 禁止混入无关格式化或自动生成文件，确保每次合并干净、可回滚。
